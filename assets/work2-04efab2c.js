import{S as _,T as E}from"./index-fe195011.js";import{B as V}from"./index-1fbd3817.js";import{d as $,r as M,a as j,o as q,c as G,b as w,e as C,w as I,f as B}from"./index-ca826a97.js";import{A as J}from"./Application-dda44c9e.js";const K={class:"nav_content flex items-center justify-center"},O={class:"flex mt-[120px]"},Q=w("div",{class:"w-[240px]"},null,-1),U=w("div",{class:"w-[250px]"},null,-1),ae=$({__name:"work2",setup(Z){const y=M(),f=M(),h=M({status:"",startPoint:{x:0,y:0},currentDrawRectIng:null,boxInsance:null});j(()=>{T()});async function T(){var o,a;const e=new J;f.value=e;const n=(o=y.value)==null?void 0:o.getAttribute("width");let t=800;n&&(t=parseInt(n)),window.__PIXI_APP__=e,await e.init({width:t,height:800,background:"#EFEFEF",antialias:!0}),(a=y.value)==null||a.appendChild(e.canvas)}function H(){var n,t;for(let o=0;o<4;o++){const a=new _(E.WHITE);a.label=`line${o}`,a.tint="#abcdef",a.eventMode="static",(o==0||o==2)&&(a.height=4,a.cursor="n-resize"),(o==1||o==3)&&(a.width=4,a.cursor="e-resize"),(n=f.value)==null||n.stage.addChild(a)}let e=10;for(let o=0;o<4;o++){const a=new _(E.WHITE);a.label=`minibox${o}`,a.tint="#abcdef",a.setSize(e),a.anchor.set(.5),a.eventMode="static",(o==0||o==2)&&(a.cursor="ne-resize"),(o==1||o==3)&&(a.cursor="nw-resize"),(t=f.value)==null||t.stage.addChild(a)}}function P(e,n){const t=h.value.currentDrawRectIng;let o=0,a=0,i=e.x,c=e.y,r=t.width,v=t.height;function x(s){o=s.pageX,a=s.pageY,i=e.x,c=e.y,r=t.width,v=t.height,W(t),window.addEventListener("mousemove",b)}function b(s){const{pageX:l,pageY:d}=s,u=l-o,g=d-a;if(n==0||n==3){const m=L(t);n==0?m[1]=c+g:m[2]=i+u,p(m),n==0&&(t.height=v-g),n==3&&(t.width=r-u)}if(n==1||n==2){const m=L(t);n==1?m[0]=i+u:m[3]=c+g,p(m)}}e.addEventListener("mousedown",x),window.addEventListener("mouseup",s=>{window.removeEventListener("mousemove",b)})}function W(e){if(!e)return;const n=e.anchor;let t=e.x,o=e.y;const a=n.x==0&&n.y==1,i=n.x==1&&n.y==1,c=n.x==1&&n.y==0,r=n.x==0&&n.y==0;a&&(o=o-e.height),i&&(t=t-e.width,o=o-e.height),c&&(t=t-e.width),r&&(o=o+e.height),e.x=t,e.y=o,e==null||e.anchor.set(0,1)}function L(e){const n=e.anchor;let t=e.x,o=e.y,a=0,i=0;const c=n.x==0&&n.y==1,r=n.x==1&&n.y==1,v=n.x==1&&n.y==0,x=n.x==0&&n.y==0;return c&&(o=o-e.height,a=t+e.width,i=o+e.height),r&&(t=t-e.width,o=o-e.height,a=t,i=o),v&&(t=t-e.width,a=t,i=o+e.height),x&&(a=t+e.width,i=o+e.height),[t,o,a,i]}function D(){var n;const e=(n=f.value)==null?void 0:n.stage.children.filter(t=>t.label.includes("line"));e==null||e.map((t,o)=>{P(t,o)})}function R(e){const[n,t,o,a]=e;let i=o-n,c=a-t;const r=h.value.currentDrawRectIng;i>0&&c>0&&(r==null||r.anchor.set(0,0)),i>0&&c<0&&(r==null||r.anchor.set(0,1)),i<0&&c<0&&(r==null||r.anchor.set(1,1)),i<0&&c>0&&(r==null||r.anchor.set(1,0)),r==null||r.setSize(Math.abs(i),Math.abs(c))}function p(e){var b;const[n,t,o,a]=e;let i=o-n,c=a-t;const r=((b=f.value)==null?void 0:b.stage.children)||[];let v=[],x=[];x=r.filter(s=>s.label.includes("minibox")).sort((s,l)=>{const d=s.label.substr(-1),u=l.label.substr(-1);return parseInt(d)-parseInt(u)}),v=r.filter(s=>s.label.includes("line")).sort((s,l)=>{const d=s.label.substr(-1),u=l.label.substr(-1);return parseInt(d)-parseInt(u)}),v.map((s,l)=>{let d=n,u=t;(l==0||l==2)&&(s.width=Math.abs(i)),(l==1||l==3)&&(s.height=Math.abs(c)),(l==0||l==1)&&(s.y=u,s.x=d),l==2&&(s.y=u+Math.abs(c),s.x=d),l==3&&(s.y=u,s.x=d+Math.abs(i)),i>0&&c<0&&(s.y=s.y-Math.abs(c)),i<0&&c<0&&(s.y=s.y-Math.abs(c),s.x=s.x-Math.abs(i)),i<0&&c>0&&(s.x=s.x-Math.abs(i))}),x.map((s,l)=>{s.x={0:n+Math.abs(i),1:n,2:n,3:n+Math.abs(i)}[l],s.y={0:t,1:t,2:t+Math.abs(c),3:t+Math.abs(c)}[l],i>0&&c<0&&(s.y=s.y-Math.abs(c)),i<0&&c<0&&(s.y=s.y-Math.abs(c),s.x=s.x-Math.abs(i)),i<0&&c>0&&(s.x=s.x-Math.abs(i))})}function X(){const e=f.value.stage,n=[];e.children.map((t,o)=>{(t.label.includes("line")||t.label.includes("minibox"))&&n.push(o)}),e.removeChildren(n[0],n[n.length-1])}function z(e){this.style.cursor="crosshair"}function S(e){var i;X();const n=f.value.canvas,{offsetX:t,offsetY:o}=e;h.value.startPoint={x:t,y:o};const a=new _(E.WHITE);a.x=t,a.y=o,h.value.currentDrawRectIng=a,a.setSize(0),(i=f.value)==null||i.stage.addChild(a),n.addEventListener("mousemove",Y),H()}function Y(e){const{offsetX:n,offsetY:t}=e,{x:o,y:a}=h.value.startPoint;R([o,a,n,t]),p([o,a,n,t])}function k(e){A(),D()}function F(){h.value.status="container";const e=f.value.canvas;e.addEventListener("mouseenter",z),e.addEventListener("mousedown",S),e.addEventListener("mouseup",k)}function A(){h.value.status="";const e=f.value.canvas;e.removeEventListener("mouseenter",z),e.removeEventListener("mousedown",S),e.removeEventListener("mouseup",k),e.removeEventListener("mousemove",Y),e.style.cursor="auto"}function N(){A(),X()}return(e,n)=>{const t=V;return q(),G("div",null,[w("div",K,[C(t,{type:"info",onClick:N},{default:I(()=>[B("选择")]),_:1}),C(t,{type:"danger",onClick:F},{default:I(()=>[B("容器")]),_:1}),C(t,{type:"primary"},{default:I(()=>[B("矩形")]),_:1})]),w("div",O,[Q,w("div",{ref_key:"container",ref:y,class:"container flex-1 bg-slate-300"},null,512),U])])}}});export{ae as default};
