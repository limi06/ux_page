import{d as o,r as c,a as g,o as x,c as y,b as v}from"./index-f64b4eb4.js";class C{constructor(){var t=document.getElementById("myCanvas");this.ctx=t.getContext("2d"),t.width=1900,t.height=800,this.unit=14,this.startX=1300/2,this.startY=20}paint(t){this.ctx.clearRect(0,0,1e3,800);const e=(l,s)=>{let n=0;if(l.left||l.right){if(l.left){let a=l.right?1:2;n+=a+e(l.left),(l.left.left||l.left.right)&&n--}if(l.right){let a=l.left?1:2;n+=a+e(l.right),(l.right.left||l.right.right)&&n--}}else return l.with=0,0;return l.with=n,n};e(t),console.log(t,"roottt");const r=(l,s)=>{var u;if(!l)return;let n,a;s=="root"?(n=this.startX+Number(l.x||0),a=this.startY+Number(l.y||0)):s=="left"?(n=l.parent.x-(l.with||.6)*this.unit*4,a=l.parent.y+5*this.unit):s=="right"&&(n=l.parent.x+(l.with||.6)*this.unit*4,a=l.parent.y+5*this.unit),l.x=n,l.y=a,this.drawNode(n,a,l.value,l.color==1?"red":"black",((u=l==null?void 0:l.parent)==null?void 0:u.value)||0),l.left&&(r(l.left,"left"),this.line(n,a+1.5*this.unit,l.left.x,l.left.y-1.5*this.unit)),l.right&&(r(l.right,"right"),this.line(n,a+1.5*this.unit,l.right.x,l.right.y-1.5*this.unit))};r(t,"root")}circle(t,e,r,l){this.ctx.beginPath(),this.ctx.arc(t,e,r,0,2*Math.PI),this.ctx.fillStyle=l,this.ctx.fill()}text(t,e,r,l){this.ctx.font=r+"px sans-serif";let s=e+r/2.5,n=t-r*l.length/3.4;this.ctx.fillStyle="white",this.ctx.fillText(l,n,s)}square(t,e,r,l){let s=t-r/2,n=e-l/2;this.ctx.fillStyle="black",this.ctx.fillRect(s,n,r,l)}line(t,e,r,l){this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(r,l),this.ctx.strokeStyle="black",this.ctx.stroke()}drawNode(t,e,a,l="black",s){let n=1.5*this.unit;this.circle(t,e,n,l);var a=a+"";let u=10;this.text(t,e,u,a)}drawNullNode(t,e){let r=this.unit*2,l=this.unit*3;this.square(t,e,r,l);let s=this.unit*1.8;this.text(t,e,s,"n")}}const d={RED:1,BLACK:2};function f(i){return i===d.RED?d.BLACK:d.RED}function p(i){return i&&i.color===d.RED}function m(i){if(!i.parent)return null;if(i.parent.left==i)return i.parent.right;if(i.parent.right==i)return i.parent.left}function w(i){let t=i.parent,e=i.left,r=i.right;if(t.value>i.value){if(e&&p(e)){let l=t.left==i?"left":"right",s=i.right;if(i.right=t,i.color=f(i.color),i.parent=t.parent,t.parent){let n=t.parent.left==t?"left":"right";t.parent[n]=i}if(t.color=f(t.color),t.parent=i,t[l]=s,s&&(s.parent=t),!i.parent)return i}if(r&&p(r)){let l=t.left==i?"left":"right",s=r.right,n=r.left;if(r.right=t,r.parent=t.parent,r.left=i,i.parent=r,r.color=f(r.color),t.parent){let a=t.parent.left==t?"left":"right";t.parent[a]=r}if(t.color=f(t.color),t.parent=r,t[l]=s,s&&(s.parent=t),i.right=n,n&&(n.parent=i),!r.parent)return r}return}if(i.value>t.value){if(r&&p(r)){let l=t.left==i?"left":"right",s=i.left;if(i.left=t,i.color=f(i.color),i.parent=t.parent,t.parent){let n=t.parent.left==t?"left":"right";t.parent[n]=i}if(t.color=f(t.color),t.parent=i,t[l]=s,s&&(s.parent=t),!i.parent)return i}if(e&&p(e)){let l=t.left==i?"left":"right",s=e.left,n=e.right;if(e.right=i,e.left=t,e.color=f(e.color),i.parent=e,e.parent=t.parent,t.parent){let a=t.parent.left==t?"left":"right";t.parent[a]=e}if(t.color=f(t.color),t.parent=e,t[l]=s,s&&(s.parent=t),i.left=n,n&&(n.parent=i),!e.parent)return e}}}class _{constructor(){this.color=null,this.data=null,this.left=null,this.right=null,this.parent=null,this.value=null}}class T{constructor(){this.root=null}init(t){t.map(e=>this.addNode(e))}addToChild(t,e,r){e||(e=this.root),t.data>e.data?e.right?this.addToChild(t,e.right,"inner"):(e.right=t,t.parent=e):e.left?this.addToChild(t,e.left,"inner"):(e.left=t,t.parent=e),this.loopExchange(t)}loopExchange(t){let e=t.parent;if(p(e)){let r=m(e);if(p(e.left)||p(e.right))if(!r||!p(r)){const l=w(e);l&&(this.root=l)}else p(r)&&(e.color=f(e.color),r.color=f(r.color),e.parent.color=f(e.parent.color),this.loopExchange(e.parent))}}addNode(t){if(this.root==null){this.root={},this.root.color=d.BLACK,this.root.data=t,this.root.value=t;return}let e=new _;e.color=d.RED,e.data=t,e.parent=null,e.value=t,e.value==22,this.addToChild(e,null),this.root.color=d.BLACK}}const B={class:""},N=v("canvas",{id:"myCanvas",width:"1300",height:"800",style:{border:"1px solid #d3d3d3"}}," 您的浏览器不支持 HTML5 canvas 标签。",-1),E=[N],D=o({__name:"redTree",setup(i){const t=c([50,40,80,20,45,60,100,96,110,62,55,53]),e=new T,r=c(null);g(()=>{r.value=new C,l(),e.init(t.value),console.log(e.root,"root"),s()});function l(){t.value=[];for(let n=0;n<=20;n++){let a=Math.random()*1e3;t.value.push(Math.floor(a))}}function s(){var u;let n="";function a(h){if(!h)return null;h.left&&h.left.data&&a(h.left),h.data&&(n=n+h.data+" | "),h.right&&h.right.data&&a(h.right)}a(e.root),(u=r.value)==null||u.paint(e.root),console.log(n,"str")}return(n,a)=>(x(),y("div",B,E))}});export{D as default};
