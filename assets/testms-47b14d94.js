import{i as M,j as B,r as m,k as C,d as b,a as k,o as _,c as x,b as h,F as I,l as L,n as g,t as A,e as y,w as D,u as q,f as T}from"./index-f64b4eb4.js";import{R as H}from"./red2-282fd708.js";import{B as V}from"./index-e9d00a60.js";function E(d){return M()?(B(d),!0):!1}const N=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const P=N?window:void 0;function R(d,i={}){const{immediate:r=!0,fpsLimit:u=void 0,window:n=P}=i,a=m(!1),c=u?1e3/u:null;let s=0,f=null;function p(e){if(!a.value||!n)return;s||(s=e);const l=e-s;if(c&&l<c){f=n.requestAnimationFrame(p);return}s=e,d({delta:l,timestamp:e}),f=n.requestAnimationFrame(p)}function o(){!a.value&&n&&(a.value=!0,s=0,f=n.requestAnimationFrame(p))}function t(){a.value=!1,f!=null&&n&&(n.cancelAnimationFrame(f),f=null)}return r&&o(),E(t),{isActive:C(a),pause:t,resume:o}}function W(d){var i;const r=m(0);if(typeof performance>"u")return r;const u=(i=d==null?void 0:d.every)!=null?i:10;let n=performance.now(),a=0;return R(()=>{if(a+=1,a>=u){const c=performance.now(),s=c-n;r.value=Math.round(1e3/(s/a)),n=c,a=0}}),r}const F=100,S=10,z=b({__name:"virtualList2",setup(d){const i=m([]),r=m([]),u=m(),n=m(0),a=new H;m([0,120,200,340,460,540,640,760,900,980,1060,1200,1320,1400,1540,1660,1780,1920,2060,2200]),k(()=>{let o=[80,100,120,140];for(let t=0;t<F;t++){let e=Math.random()*o.length;e=Math.floor(e),r.value.push({index:t,text:t+1,h:o[e],top:n.value}),a.add({num:n.value,data:t}),n.value+=o[e]}f()});function c(o){let t=0,e=0,l=r.value.length-1;for(;e<=l;){const v=Math.floor((e+l)/2),w=r.value[v].top;if(w===o)return v;if(o<w?l=v-1:e=v+1,e===l)return e;if(e>l)return l}return t}function s(o){let t=u.value.offsetHeight;for(let e=o;e<r.value.length;e++)if(t-=r.value[e].h,t<0)return e-o;return 0}function f(){let o=0;o=u.value.scrollTop;const t=c(o),e=s(t),l=t+e,v=Math.max(0,t-S/2),w=Math.min(F,l+S/2+10);i.value=r.value.slice(v,w)}function p(o){requestAnimationFrame(f)}return(o,t)=>(_(),x("div",{class:"overflow-auto w-full h-full",onScroll:p,ref_key:"container",ref:u},[h("div",{class:"relative",style:g({height:n.value+"px"})},[(_(!0),x(I,null,L(i.value,(e,l)=>(_(),x("div",{class:"item border-b absolute w-full",style:g({top:e.top+"px",height:e.h+"px"}),key:l}," 第 "+A(e.text)+" 个 ",5))),128))],4)],544))}}),G=h("div",null,[T("FPS: "),h("span",{id:"fps"})],-1),O={class:"w-[300px] h-[800px] border-[2px]"},$=50,Q=b({__name:"testms",setup(d){let i=0,r,u=Date.now();const n=W();k(()=>{a(),c()});function a(){document.getElementById("fps").innerHTML=(i*100).toFixed(1),setTimeout(a,1e3)}function c(){r=Date.now();var s=1e3/(r-u);i=(s-i)/$,u=r,setTimeout(c,1)}return(s,f)=>{const p=V;return _(),x("div",null,[y(p,null,{default:D(()=>[T("按钮")]),_:1}),G,h("div",null,"vue fps: "+A(q(n)),1),h("div",O,[y(z)])])}}});export{Q as default};
