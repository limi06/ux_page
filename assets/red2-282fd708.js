var D=Object.defineProperty;var k=(t,e,i)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var s=(t,e,i)=>(k(t,typeof e!="symbol"?e+"":e,i),i);const p=new Map;function w(t){return t===1?2:1}function l(t){return t&&t.color===1}class x{constructor(){s(this,"color",1);s(this,"data",[]);s(this,"tag",0)}}function M(t,{num:e,data:i}){var f;if(!t){const g=new x;g.color=1,g.data=[e],g.tag=e;const d=new Map;return d.set(i.id,i.list),g.obj=d,g}return e>t.tag?t.right=M(t.right,{num:e,data:i}):e<t.tag?t.left=M(t.left,{num:e,data:i}):(t.obj.set(i.id,i.list),t.obj.size>=2&&p.set(t.tag,t)),l(t==null?void 0:t.right)&&!l(t==null?void 0:t.left)&&(t=C(t)),l(t==null?void 0:t.left)&&l((f=t==null?void 0:t.left)==null?void 0:f.left)&&(t=u(t)),l(t==null?void 0:t.left)&&l(t==null?void 0:t.right)&&j(t),t}function C(t){var f;const e=(f=t.right)==null?void 0:f.left,i=t.right;return t.right.left=t,t.right=e,t.color==2&&(i.color=2),t.color=1,t=i,t}function u(t){const e=t.left;return t.left=e==null?void 0:e.right,e.right=t,e.color=t.color,t.color=1,e}function j(t){t.color=w(t.color),t.left&&(t.left.color=w(t.left.color)),t.right&&(t.right.color=w(t.right.color))}function N(t){var e;return t?(l(t.right)&&!l(t.lfet)&&(t=C(t)),l(t.left)&&l((e=t.left)==null?void 0:e.left)&&(t=u(t)),l(t.left)&&l(t.right)&&j(t),t):null}function L(t){return j(t),t.right&&l(t.right.left)&&(t.right=u(t.right)),t}function A(t){var e;return j(t),l(t.left)&&l((e=t.left)==null?void 0:e.left)&&(t=u(t),j(t)),t}function z(t){return t!=null&&t.left&&(t=z(t.left)),t}function B(t){var e;return t.left?(!l(t.left)&&!l((e=t.left)==null?void 0:e.left)&&(t=L(t)),t.left=B(t.left),N(t)):null}function R(t,e,i){var f,g,d;if((t==null?void 0:t.tag)>e)!l(t.left)&&!l((f=t.left)==null?void 0:f.left)&&(t=L(t)),t.left=R(t.left,e);else if((t==null?void 0:t.tag)<e)l(t.left)&&!l(t.right)&&(t=u(t)),!l(t.right)&&!l((g=t.right)==null?void 0:g.left)&&(t=A(t)),t.right=R(t.right,e);else{if(l(t.left)&&!l(t.right))return t=u(t),t=R(t,e),N(t);if(t.right&&!l(t.right)&&!l((d=t.right)==null?void 0:d.left))return t=A(t),t=R(t,e),N(t);const v=z(t.right);v?(t.data=v.data,t.tag=v.tag,t.obj=v.obj,t.right=B(t.right)):t=null}return N(t)}class T{constructor(){s(this,"root",null);s(this,"originDataAry",[])}init(e){this.originDataAry=[...e],e.map(i=>this.add(i))}add(e){this.root=M(this.root,e),this.root.color=2}delete(e,i){if(p.has(e)){const f=p.get(e);f.obj.delete(i)&&f.obj.size<=1&&p.delete(e);return}this.root=R(this.root,e),this.root&&(this.root.color=2)}find(e){let i=this.root,f=null;for(;i;)if(e>i.tag)f=i,i=i.right;else if(e<i.tag)f=i,i=i.left;else return i||f;return i||f}count(){function e(i){return i==null?0:e(i==null?void 0:i.left)+e(i==null?void 0:i.right)+1}return e(this.root)}getMap(){return p}}export{T as R};
