var B=Object.defineProperty;var M=(o,t,e)=>t in o?B(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var d=(o,t,e)=>(M(o,typeof t!="symbol"?t+"":t,e),e);import{h as k}from"./index-0070c043.js";import{R as p}from"./red2-282fd708.js";function z({x:o,y:t,x2:e,y2:i}){let s=o<e?o:e,h=t<i?t:i;const n=Math.abs(e-o),r=Math.abs(i-t);return{x:s,y:h,width:n,height:r}}function P(o,t,e={}){for(let i in o)if(o[i]!==t[i]&&i!=="target"&&!e[i]||i==="target"&&o[i].uid!==t[i].uid)return!1;return!0}let b=class{constructor(t){d(this,"x");d(this,"y");d(this,"width");d(this,"height");d(this,"target");d(this,"container");this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.target=t.target,this.container=t==null?void 0:t.container}};class I{constructor(t){d(this,"indexs");d(this,"bounds");d(this,"maxObjects");d(this,"objects");d(this,"tag");this.indexs=[],this.bounds=t,this.maxObjects=3,this.objects=[],this.tag=""}split(){const t=this.bounds.width/2,e=this.bounds.height/2,i=this.bounds.x+t,s=this.bounds.y+e;this.indexs[0]=new I({x:i,y:this.bounds.y,width:t,height:e}),this.indexs[1]=new I({x:this.bounds.x,y:this.bounds.y,width:t,height:e}),this.indexs[2]=new I({x:this.bounds.x,y:s,width:t,height:e}),this.indexs[3]=new I({x:i,y:s,width:t,height:e})}getIndexs(t){var w,y,a,m;t.width,t.height;const e=t.x,i=t.y,s=t.width+e,h=t.height+i,n=this.indexs[0].bounds,r=this.indexs[1].bounds,g=this.indexs[2].bounds,l=this.indexs[3].bounds;let f=n.x,u=n.y+n.height;if(t.x+t.width>f&&t.x<f){const c={...t,width:f-t.x},j={...t,x:f,width:t.x+t.width-f};return(w=this.getIndexs(c))==null||w.add(new b(c)),(y=this.getIndexs(j))==null||y.add(new b(j)),null}if(t.y+t.height>u&&t.y<u){const c={...t,height:u-t.y},j={...t,y:u,height:t.y+t.height-u};return(a=this.getIndexs(c))==null||a.add(new b(c)),(m=this.getIndexs(j))==null||m.add(new b(j)),null}function x(c){return e>=c.x&&i>=c.y&&s<=c.x+c.width&&h<=c.y+c.height}if(x(n))return this.indexs[0];if(x(r))return this.indexs[1];if(x(g))return this.indexs[2];if(x(l))return this.indexs[3]}delGetIndexs(t){var w,y,a,m;t.width,t.height;const e=t.x,i=t.y,s=t.width+e,h=t.height+i,n=this.indexs[0].bounds,r=this.indexs[1].bounds,g=this.indexs[2].bounds,l=this.indexs[3].bounds;let f=n.x,u=n.y+n.height;if(t.x+t.width>f&&t.x<f){const c={...t,width:f-t.x},j={...t,x:f,width:t.x+t.width-f};return(w=this.delGetIndexs(c))==null||w.delete(new b(c)),(y=this.delGetIndexs(j))==null||y.delete(new b(j)),null}if(t.y+t.height>u&&t.y<u){const c={...t,height:u-t.y},j={...t,y:u,height:t.y+t.height-u};return(a=this.delGetIndexs(c))==null||a.delete(new b(c)),(m=this.delGetIndexs(j))==null||m.delete(new b(j)),null}function x(c){return e>=c.x&&i>=c.y&&s<=c.x+c.width&&h<=c.y+c.height}if(x(n))return this.indexs[0];if(x(r))return this.indexs[1];if(x(g))return this.indexs[2];if(x(l))return this.indexs[3]}add(t){var e,i;if(this.objects.push(t),this.objects.sort((s,h)=>h.target.uid-s.target.uid),!(this.objects.length<=this.maxObjects&&this.indexs.length===0))if(this.indexs.length)(i=this.getIndexs(t))==null||i.add(t),this.objects=[];else{this.split();for(const s of this.objects)(e=this.getIndexs(s))==null||e.add(s);this.objects=[]}}delete(t){var e;if(this.indexs.length==0){const i=this.objects.findIndex(s=>P(s,t,{container:1}));this.objects.splice(i,1)}else(e=this.delGetIndexs(t))==null||e.delete(t)}searchPoint(t){if(this.indexs.length===0)return this.objects;const e=this.bounds.width/2,i=this.bounds.height/2,s=this.bounds.x+e,h=this.bounds.y+i,n=t.y<h,r=t.y>h,g=t.x>s,l=t.x<s;if(n&&g)return this.indexs[0].searchPoint(t);if(n&&l)return this.indexs[1].searchPoint(t);if(r&&l)return this.indexs[2].searchPoint(t);if(r&&g)return this.indexs[3].searchPoint(t)}init(t){for(let e=0;e<t.length;e++){const i=new b(t[e]);this.add(i)}}}function A({x:o,y:t,x2:e,y2:i}){let s=o<e?o:e,h=t<i?t:i;const n=Math.abs(e-o),r=Math.abs(i-t);return{x:s,y:h,width:n,height:r}}function C(o,t){for(let e in o)if(o[e]!==t[e]&&e!=="target"||e==="target"&&o[e].uid!==t[e].uid)return!1;return!0}class v{constructor(t,e,i){d(this,"obj");d(this,"left");d(this,"right");d(this,"parent");d(this,"dimension");this.obj=t,this.left=null,this.right=null,this.parent=i,this.dimension=e}}class F{constructor(t,e,i){d(this,"root");d(this,"metric");d(this,"dimensions");this.root=null,this.metric=e,this.dimensions=i,Array.isArray(t)?this.root=this.buildTree(t,0,null):this.loadTree(t)}buildTree(t,e,i){var s=e%this.dimensions.length,h,n;return t.length===0?null:t.length===1?new v(t[0],s,i):(t.sort((r,g)=>r[this.dimensions[s]]-g[this.dimensions[s]]),h=Math.floor(t.length/2),n=new v(t[h],s,i),n.left=this.buildTree(t.slice(0,h),e+1,n),n.right=this.buildTree(t.slice(h+1),e+1,n),n)}loadTree(t){this.root=t;function e(i){i!=null&&i.left&&(i.left.parent=i,e(i.left)),i!=null&&i.right&&(i.right.parent=i,e(i.right))}e(this.root)}toJSON(t){t||(t=this.root);var e=new v(t.obj,t.dimension,null);return t.left&&(e.left=this.toJSON(t.left)),t.right&&(e.right=this.toJSON(t.right)),e}insert(t){const e=(n,r)=>{if(n===null)return r;var g=this.dimensions[n.dimension];return t[g]<n.obj[g]?e(n.left,n):e(n.right,n)};var i=e(this.root,null),s,h;if(i===null){this.root=new v(t,0,null);return}s=new v(t,(i.dimension+1)%this.dimensions.length,i),h=this.dimensions[i.dimension],t[h]<i.obj[h]?i.left=s:i.right=s}remove(t){var e;let i=this;const s=n=>{if(n===null)return null;if(C(n.obj,t))return n;var r=this.dimensions[n.dimension];return t[r]<n.obj[r]?s(n.left):s(n.right)},h=n=>{var r,g,l;function f(u,x){var w,y,a,m,c;return u===null?null:(w=i.dimensions[x],u.dimension===x?u.left!==null?f(u.left,x):u:(y=u.obj[w],a=f(u.left,x),m=f(u.right,x),c=u,a!==null&&a.obj[w]<y&&(c=a),m!==null&&m.obj[w]<c.obj[w]&&(c=m),c))}if((n==null?void 0:n.left)===null&&(n==null?void 0:n.right)===null){if(n.parent===null){i.root=null;return}l=i.dimensions[n.parent.dimension],n.obj[l]<n.parent.obj[l]?n.parent.left=null:n.parent.right=null;return}(n==null?void 0:n.right)!==null?(r=f(n.right,n.dimension),g=r.obj,h(r),n.obj=g):(r=f(n.left,n.dimension),g=r.obj,h(r),n.right=n.left,n.left=null,n.obj=g)};if(e=s(i.root),e!==null)return h(e),e}nearest(t,e,i){var s,h,n;n=new N(function(l){return-l[1]});let r=this;function g(l){var f;r.dimensions[l.dimension],r.metric(t,l.obj);var u={},x={},w,y,a;function m(c,j){n.push([c,j]),n.size()>e&&n.pop()}for(a=0;a<r.dimensions.length;a+=1)a===l.dimension?(u[r.dimensions[a]]=t[r.dimensions[a]],x[r.dimensions[a]]=l.obj[r.dimensions[a]]):(u[r.dimensions[a]]=l.obj[r.dimensions[a]],x[r.dimensions[a]]=t[r.dimensions[a]]);if(w=r.metric(u,l.obj),y=r.metric(x,l.obj),l.right===null&&l.left===null){(n.size()<e||w<n.peek()[1])&&m(l,w),(n.size()<e||y<n.peek()[1])&&m(l,y);return}l.right&&(f=l.right,g(f)),l.left&&(f=l.left,g(f)),(n.size()<e||w<n.peek()[1])&&m(l,w),(n.size()<e||y<n.peek()[1])&&m(l,y)}if(i)for(s=0;s<e;s+=1)n.push([null,i]);for(r.root&&g(r.root),h=[],s=0;s<Math.min(e,n.content.length);s+=1)n.content[s][0]&&h.push([n.content[s][0].obj,n.content[s][1]]);return h}balanceFactor(){let t=this;function e(s){return s===null?0:Math.max(e(s.left),e(s.right))+1}function i(s){return s===null?0:i(s.left)+i(s.right)+1}return e(t.root)/(Math.log(i(t.root))/Math.log(2))}count(){function t(e){return e===null?0:t(e.left)+t(e.right)+1}return t(this.root)}}class N{constructor(t){d(this,"scoreFunction");d(this,"content");this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.bubbleUp(this.content.length-1)}pop(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t}peek(){return this.content[0]}remove(t){for(var e=this.content.length,i=0;i<e;i++)if(this.content[i]==t){var s=this.content.pop();i!=e-1&&(this.content[i]=s,this.scoreFunction(s)<this.scoreFunction(t)?this.bubbleUp(i):this.sinkDown(i));return}throw new Error("Node not found.")}size(){return this.content.length}bubbleUp(t){for(var e=this.content[t];t>0;){var i=Math.floor((t+1)/2)-1,s=this.content[i];if(this.scoreFunction(e)<this.scoreFunction(s))this.content[i]=e,this.content[t]=s,t=i;else break}}sinkDown(t){for(var e=this.content.length,i=this.content[t],s=this.scoreFunction(i);;){var h=(t+1)*2,n=h-1,r=null;if(n<e){var g=this.content[n],l=this.scoreFunction(g);l<s&&(r=n)}if(h<e){var f=this.content[h],u=this.scoreFunction(f);u<(r==null?s:l)&&(r=h)}if(r!=null)this.content[t]=this.content[r],this.content[r]=i,t=r;else break}}}function S(o,t){var e=o.x-t.x,i=o.y-t.y;return e*e+i*i}const D=k("common",{state:()=>({pixiApp:null,startPoint:{x:0,y:0},currentNode:null,status:"select",currentNodeMoveEvent:null,preBounds:null,rects:[],quadTree:null,selectNode:null,rootContainer:null,currentContainerNode:null,currentSpriteNode:null,borderLineEditIndex:-1,borderBoxEditIndex:-1,borderEditType:"line",cloneEditBeforeBounds:{x:0,y:0,width:0,height:0},redTreeAdsXInstance:new p,redTreeAdsYInstance:new p,kdInstance:new F([],S,["x","y"]),adsGraphicInstance:null,allPointMap:new Map,globalScale:100,leftList:[],currentLeftUid:-1}),actions:{setCurrentNode(o,t){this.currentSpriteNode=o,t&&(this.currentContainerNode=t),t||(this.currentContainerNode=null)}}});export{b as N,I as Q,z as a,C as b,D as c,A as d,P as e};
